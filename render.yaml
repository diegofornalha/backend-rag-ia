# Exported from Render on 2024-12-27T10:09:24Z
databases:
  - name: vector_store
    databaseName: embeddings
    user: postgres
    plan: starter
    postgresMajorVersion: 15
    ipAllowList: []
    backup:
      enabled: true
      schedule: 0 0 * * * # Backup diário à meia-noite
    extensions:
      - vector

  - name: cache
    type: redis
    ipAllowList: []
    plan: starter
    maxmemoryPolicy: allkeys-lru
    backup:
      enabled: true
      schedule: 0 0 * * * # Backup diário à meia-noite

services:
  - type: web
    name: backend-rag-ia
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn -c gunicorn.conf.py backend_rag_ia.main:app
    healthCheckPath: /health
    healthCheckTimeout: 60
    autoscaling:
      min: 1
      max: 3
    resources:
      cpu: 1000
      memory: 1024
      storage: 512
    envVars:
      - key: ENVIRONMENT
        value: production
      - key: GEMINI_API_KEY
        sync: false
      - key: PORT
        value: 10000
      - key: HOST
        value: 0.0.0.0
      - key: WORKERS
        value: 4
      - key: TIMEOUT
        value: 120
      - key: LOG_LEVEL
        value: info
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_KEY
        sync: false
      - key: SUPABASE_SERVICE_KEY
        sync: false
      - key: VECTOR_STORE_TYPE
        value: pgvector
      - key: EMBEDDINGS_MODEL
        value: text-embedding-ada-002
      - key: MAX_TOKENS
        value: 8192
      - key: CHUNK_SIZE
        value: 1000
      - key: CHUNK_OVERLAP
        value: 200
    autoDeploy: true
    disk:
      name: tmp
      mountPath: /tmp
      sizeGB: 1
    metrics:
      enabled: true
      path: /metrics

# Configuração de previews
previews:
  enable: true
  spec:
    inheritEnvVars: true
    envVars:
      - key: ENVIRONMENT
        value: preview
      - key: DEBUG
        value: true
    plan: starter
    resources:
      cpu: 500
      memory: 512

version: "1"
